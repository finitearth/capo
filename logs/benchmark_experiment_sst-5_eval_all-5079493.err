Running experiment with args: {'experiment_name': 'benchmark_experiment_agnews_llama_CAPO_44', 'random_seed': 44, 'budget_per_run': 10000000, 'output_dir': 'results//agnews/llama/CAPO/seed44/', 'dataset': 'agnews', 'model': 'vllm-shuyuej/Llama-3.3-70B-Instruct-GPTQ', 'model_revision': '3a7f7f7d46e362291821aaefb0a38b632f1190a8', 'max_model_len': 1024, 'batch_size': None, 'model_storage_path': '../models/', 'optimizer': 'CAPO', 'n_steps': 999, 'population_size': 12, 'n_eval_samples': None, 'evoprompt_ga_template': 'standard', 'block_size': 30, 'length_penalty': 0.05, 'crossovers_per_iter': 4, 'upper_shots': 8, 'max_n_blocks_eval': 10, 'alpha': 0.2, 'shuffle_blocks_per_iter': False}
Found 33 unique prompts
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:75: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = df[config.target]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:75: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = df[config.target]
/dss/dsshome1/02/ra42vur3/miniforge3/envs/py312/lib/python3.12/site-packages/promptolution/tasks/classification_tasks.py:56: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[y_column] = df[y_column].str.lower()
Loading safetensors checkpoint shards:   0% Completed | 0/8 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  12% Completed | 1/8 [00:02<00:18,  2.70s/it]
Loading safetensors checkpoint shards:  25% Completed | 2/8 [00:05<00:16,  2.70s/it]
Loading safetensors checkpoint shards:  38% Completed | 3/8 [00:06<00:10,  2.06s/it]
Loading safetensors checkpoint shards:  50% Completed | 4/8 [00:09<00:08,  2.22s/it]
Loading safetensors checkpoint shards:  62% Completed | 5/8 [00:11<00:07,  2.38s/it]
Loading safetensors checkpoint shards:  75% Completed | 6/8 [00:14<00:04,  2.47s/it]
Loading safetensors checkpoint shards:  88% Completed | 7/8 [00:17<00:02,  2.52s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:19<00:00,  2.55s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:19<00:00,  2.46s/it]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:27,  1.23it/s]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:26,  1.23it/s]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:02<00:25,  1.24it/s]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:03<00:24,  1.25it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:03<00:23,  1.26it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:04<00:22,  1.27it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:05<00:21,  1.28it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:06<00:21,  1.28it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:07<00:19,  1.32it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:07<00:18,  1.34it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:08<00:17,  1.35it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:09<00:16,  1.37it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:09<00:15,  1.39it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:10<00:14,  1.41it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:11<00:13,  1.43it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:11<00:13,  1.44it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:12<00:12,  1.48it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:13<00:11,  1.50it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:13<00:10,  1.53it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:14<00:09,  1.55it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:15<00:08,  1.58it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:15<00:08,  1.60it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:16<00:07,  1.62it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:16<00:06,  1.64it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:17<00:05,  1.70it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:17<00:05,  1.74it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:18<00:04,  1.79it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:18<00:03,  1.83it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:19<00:03,  1.86it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:19<00:02,  1.90it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:20<00:02,  1.92it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:20<00:01,  1.94it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:21<00:01,  1.94it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:22<00:00,  1.95it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:22<00:00,  1.96it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:22<00:00,  1.55it/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:16<30:37, 16.56s/it, est. speed input: 10.99 toks/s, output: 0.85 toks/s]Processed prompts: 100%|██████████| 112/112 [00:17<00:00,  8.95it/s, est. speed input: 1225.89 toks/s, output: 94.19 toks/s]Processed prompts: 100%|██████████| 112/112 [00:17<00:00,  6.42it/s, est. speed input: 1225.89 toks/s, output: 94.19 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:16<30:29, 16.48s/it, est. speed input: 10.74 toks/s, output: 0.85 toks/s]Processed prompts:  99%|█████████▉| 111/112 [00:17<00:00,  8.76it/s, est. speed input: 1197.45 toks/s, output: 92.54 toks/s]Processed prompts: 100%|██████████| 112/112 [00:17<00:00,  6.24it/s, est. speed input: 1182.09 toks/s, output: 93.70 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:16<30:23, 16.43s/it, est. speed input: 12.54 toks/s, output: 0.85 toks/s]Processed prompts:  99%|█████████▉| 111/112 [00:17<00:00,  8.79it/s, est. speed input: 1195.63 toks/s, output: 92.51 toks/s]Processed prompts: 100%|██████████| 112/112 [00:17<00:00,  6.35it/s, est. speed input: 1199.39 toks/s, output: 94.68 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:16<31:13, 16.88s/it, est. speed input: 11.32 toks/s, output: 0.83 toks/s]Processed prompts: 100%|██████████| 112/112 [00:16<00:00,  6.60it/s, est. speed input: 1280.86 toks/s, output: 95.13 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:14<26:41, 14.42s/it, est. speed input: 13.87 toks/s, output: 0.97 toks/s]Processed prompts:  38%|███▊      | 43/112 [00:14<00:16,  4.15it/s, est. speed input: 558.74 toks/s, output: 41.35 toks/s]Processed prompts:  60%|█████▉    | 67/112 [00:16<00:07,  5.80it/s, est. speed input: 714.37 toks/s, output: 84.98 toks/s]Processed prompts:  70%|██████▉   | 78/112 [00:16<00:04,  7.20it/s, est. speed input: 792.59 toks/s, output: 117.34 toks/s]Processed prompts:  77%|███████▋  | 86/112 [00:17<00:03,  8.47it/s, est. speed input: 845.66 toks/s, output: 142.51 toks/s]Processed prompts:  85%|████████▍ | 95/112 [00:17<00:01, 10.66it/s, est. speed input: 911.61 toks/s, output: 172.96 toks/s]Processed prompts:  91%|█████████ | 102/112 [00:17<00:00, 12.68it/s, est. speed input: 962.86 toks/s, output: 196.89 toks/s]Processed prompts:  97%|█████████▋| 109/112 [00:17<00:00, 14.26it/s, est. speed input: 1004.30 toks/s, output: 220.43 toks/s]Processed prompts: 100%|██████████| 112/112 [00:19<00:00,  5.64it/s, est. speed input: 917.50 toks/s, output: 213.63 toks/s] 
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:12<22:16, 12.04s/it, est. speed input: 11.13 toks/s, output: 1.16 toks/s]Processed prompts:   3%|▎         | 3/112 [00:14<07:14,  3.98s/it, est. speed input: 28.75 toks/s, output: 4.39 toks/s]Processed prompts:   4%|▎         | 4/112 [00:14<04:53,  2.72s/it, est. speed input: 37.83 toks/s, output: 6.87 toks/s]Processed prompts:   4%|▍         | 5/112 [00:15<03:26,  1.93s/it, est. speed input: 46.92 toks/s, output: 9.45 toks/s]Processed prompts:   6%|▋         | 7/112 [00:15<01:52,  1.07s/it, est. speed input: 62.25 toks/s, output: 14.78 toks/s]Processed prompts:   8%|▊         | 9/112 [00:15<01:07,  1.53it/s, est. speed input: 79.08 toks/s, output: 20.43 toks/s]Processed prompts:  12%|█▏        | 13/112 [00:15<00:31,  3.16it/s, est. speed input: 114.24 toks/s, output: 31.91 toks/s]Processed prompts:  17%|█▋        | 19/112 [00:15<00:15,  6.09it/s, est. speed input: 163.29 toks/s, output: 49.27 toks/s]Processed prompts:  29%|██▊       | 32/112 [00:15<00:05, 14.06it/s, est. speed input: 267.60 toks/s, output: 88.20 toks/s]Processed prompts:  33%|███▎      | 37/112 [00:16<00:04, 16.06it/s, est. speed input: 304.45 toks/s, output: 102.87 toks/s]Processed prompts:  44%|████▍     | 49/112 [00:16<00:02, 25.49it/s, est. speed input: 399.89 toks/s, output: 140.60 toks/s]Processed prompts:  53%|█████▎    | 59/112 [00:16<00:01, 33.61it/s, est. speed input: 480.32 toks/s, output: 172.75 toks/s]Processed prompts:  61%|██████    | 68/112 [00:16<00:01, 40.82it/s, est. speed input: 548.53 toks/s, output: 202.58 toks/s]Processed prompts:  69%|██████▉   | 77/112 [00:16<00:00, 48.50it/s, est. speed input: 614.74 toks/s, output: 233.04 toks/s]Processed prompts:  79%|███████▊  | 88/112 [00:16<00:00, 56.75it/s, est. speed input: 695.42 toks/s, output: 271.28 toks/s]Processed prompts:  87%|████████▋ | 97/112 [00:16<00:00, 60.45it/s, est. speed input: 762.64 toks/s, output: 303.57 toks/s]Processed prompts:  94%|█████████▍| 105/112 [00:17<00:00, 63.24it/s, est. speed input: 824.94 toks/s, output: 333.20 toks/s]Processed prompts: 100%|██████████| 112/112 [00:19<00:00,  5.71it/s, est. speed input: 762.73 toks/s, output: 321.16 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:12<22:38, 12.24s/it, est. speed input: 11.03 toks/s, output: 1.14 toks/s]Processed prompts:   3%|▎         | 3/112 [00:15<07:50,  4.32s/it, est. speed input: 26.87 toks/s, output: 4.56 toks/s]Processed prompts:   4%|▎         | 4/112 [00:15<05:09,  2.86s/it, est. speed input: 34.38 toks/s, output: 7.32 toks/s]Processed prompts:   4%|▍         | 5/112 [00:15<03:28,  1.95s/it, est. speed input: 41.85 toks/s, output: 10.09 toks/s]Processed prompts:   5%|▌         | 6/112 [00:15<02:24,  1.36s/it, est. speed input: 51.96 toks/s, output: 12.89 toks/s]Processed prompts:  13%|█▎        | 15/112 [00:15<00:26,  3.63it/s, est. speed input: 126.91 toks/s, output: 38.54 toks/s]Processed prompts:  17%|█▋        | 19/112 [00:15<00:17,  5.23it/s, est. speed input: 160.06 toks/s, output: 50.12 toks/s]Processed prompts:  26%|██▌       | 29/112 [00:16<00:08, 10.28it/s, est. speed input: 243.14 toks/s, output: 79.18 toks/s]Processed prompts:  39%|███▉      | 44/112 [00:16<00:03, 19.48it/s, est. speed input: 371.79 toks/s, output: 123.99 toks/s]Processed prompts:  51%|█████     | 57/112 [00:16<00:01, 28.16it/s, est. speed input: 475.49 toks/s, output: 163.90 toks/s]Processed prompts:  57%|█████▋    | 64/112 [00:16<00:01, 31.89it/s, est. speed input: 527.69 toks/s, output: 185.39 toks/s]Processed prompts:  63%|██████▎   | 71/112 [00:16<00:01, 34.06it/s, est. speed input: 576.16 toks/s, output: 207.34 toks/s]Processed prompts:  78%|███████▊  | 87/112 [00:16<00:00, 49.68it/s, est. speed input: 697.03 toks/s, output: 261.87 toks/s]Processed prompts:  88%|████████▊ | 98/112 [00:16<00:00, 57.46it/s, est. speed input: 778.05 toks/s, output: 300.27 toks/s]Processed prompts:  95%|█████████▍| 106/112 [00:17<00:00, 26.78it/s, est. speed input: 803.62 toks/s, output: 318.96 toks/s]Processed prompts: 100%|██████████| 112/112 [00:19<00:00, 10.57it/s, est. speed input: 769.57 toks/s, output: 322.27 toks/s]Processed prompts: 100%|██████████| 112/112 [00:19<00:00,  5.70it/s, est. speed input: 769.57 toks/s, output: 322.27 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]