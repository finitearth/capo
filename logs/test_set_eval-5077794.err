/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/scripts/evaluate_prompts.py:25: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  df_best = df.groupby("step").apply(lambda x: x.nlargest(1, "score")).reset_index(drop=True)
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:75: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = df[config.target]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:75: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = df[config.target]
/dss/dsshome1/02/ra42vur3/miniforge3/envs/py312/lib/python3.12/site-packages/promptolution/tasks/classification_tasks.py:56: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[y_column] = df[y_column].str.lower()
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:02<00:06,  2.01s/it]
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:04<00:04,  2.08s/it]
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:05<00:01,  1.67s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:07<00:00,  1.76s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:07<00:00,  1.81s/it]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:19,  1.73it/s]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:18,  1.79it/s]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:17,  1.78it/s]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:02<00:17,  1.78it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:02<00:16,  1.79it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:03<00:15,  1.83it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:03<00:15,  1.84it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:04<00:14,  1.82it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:04<00:14,  1.85it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:05<00:13,  1.88it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:05<00:12,  1.91it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:06<00:11,  1.93it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:06<00:11,  1.94it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:07<00:10,  1.92it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:08<00:10,  1.92it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:08<00:09,  1.95it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:09<00:09,  1.99it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:09<00:08,  2.01it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:09<00:07,  2.03it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:10<00:07,  2.04it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:10<00:06,  2.05it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:11<00:06,  2.02it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:11<00:05,  2.04it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:12<00:05,  2.04it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:12<00:04,  2.09it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:13<00:04,  2.13it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:13<00:03,  2.16it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:14<00:03,  2.18it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:14<00:02,  2.21it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:15<00:02,  2.21it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:15<00:01,  2.22it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:16<00:01,  2.18it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:16<00:00,  2.20it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:16<00:00,  2.22it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:17<00:00,  2.20it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:17<00:00,  2.01it/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:07<44:08,  7.22s/it, est. speed input: 12.89 toks/s, output: 1.39 toks/s]Processed prompts:  58%|█████▊    | 212/368 [00:10<00:05, 26.87it/s, est. speed input: 2168.87 toks/s, output: 211.30 toks/s]Processed prompts:  69%|██████▉   | 255/368 [00:10<00:03, 32.24it/s, est. speed input: 2500.06 toks/s, output: 252.07 toks/s]Processed prompts: 100%|██████████| 368/368 [00:10<00:00, 55.48it/s, est. speed input: 3482.79 toks/s, output: 358.88 toks/s]Processed prompts: 100%|██████████| 368/368 [00:10<00:00, 34.21it/s, est. speed input: 3482.79 toks/s, output: 358.88 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:07<45:28,  7.43s/it, est. speed input: 15.60 toks/s, output: 1.35 toks/s]Processed prompts:  40%|████      | 149/368 [00:10<00:12, 18.03it/s, est. speed input: 1511.31 toks/s, output: 142.42 toks/s]Processed prompts:  49%|████▉     | 181/368 [00:11<00:08, 21.57it/s, est. speed input: 1747.90 toks/s, output: 170.14 toks/s]Processed prompts:  60%|█████▉    | 219/368 [00:11<00:05, 29.34it/s, est. speed input: 2100.02 toks/s, output: 203.42 toks/s]Processed prompts:  73%|███████▎  | 268/368 [00:11<00:02, 43.26it/s, est. speed input: 2530.04 toks/s, output: 298.70 toks/s]Processed prompts:  80%|███████▉  | 294/368 [00:11<00:01, 47.00it/s, est. speed input: 2688.67 toks/s, output: 344.36 toks/s]Processed prompts:  96%|█████████▋| 355/368 [00:11<00:00, 73.80it/s, est. speed input: 3192.87 toks/s, output: 464.65 toks/s]Processed prompts: 100%|██████████| 368/368 [00:12<00:00, 29.09it/s, est. speed input: 3072.05 toks/s, output: 488.23 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:07<45:27,  7.43s/it, est. speed input: 14.53 toks/s, output: 1.35 toks/s]Processed prompts:  21%|██        | 78/368 [00:09<00:27, 10.58it/s, est. speed input: 898.81 toks/s, output: 81.67 toks/s]Processed prompts:  26%|██▌       | 96/368 [00:10<00:24, 11.33it/s, est. speed input: 990.34 toks/s, output: 92.02 toks/s]Processed prompts:  33%|███▎      | 122/368 [00:11<00:16, 15.03it/s, est. speed input: 1189.50 toks/s, output: 110.72 toks/s]Processed prompts:  65%|██████▍   | 239/368 [00:11<00:02, 45.86it/s, est. speed input: 2206.55 toks/s, output: 331.56 toks/s]Processed prompts:  75%|███████▌  | 277/368 [00:11<00:01, 57.45it/s, est. speed input: 2507.42 toks/s, output: 406.43 toks/s]Processed prompts:  83%|████████▎ | 307/368 [00:11<00:00, 64.74it/s, est. speed input: 2729.69 toks/s, output: 448.19 toks/s]Processed prompts:  93%|█████████▎| 344/368 [00:12<00:00, 82.97it/s, est. speed input: 3020.87 toks/s, output: 519.31 toks/s]Processed prompts: 100%|██████████| 368/368 [00:12<00:00, 29.01it/s, est. speed input: 3075.03 toks/s, output: 568.81 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:07<45:01,  7.36s/it, est. speed input: 13.31 toks/s, output: 1.36 toks/s]Processed prompts:  25%|██▍       | 91/368 [00:09<00:23, 11.89it/s, est. speed input: 1010.74 toks/s, output: 92.70 toks/s]Processed prompts:  28%|██▊       | 102/368 [00:10<00:22, 11.72it/s, est. speed input: 1021.14 toks/s, output: 95.99 toks/s]Processed prompts:  33%|███▎      | 123/368 [00:11<00:16, 14.84it/s, est. speed input: 1176.97 toks/s, output: 111.53 toks/s]Processed prompts:  60%|██████    | 222/368 [00:11<00:03, 41.82it/s, est. speed input: 2062.66 toks/s, output: 292.64 toks/s]Processed prompts:  69%|██████▉   | 253/368 [00:11<00:02, 51.85it/s, est. speed input: 2305.68 toks/s, output: 354.55 toks/s]Processed prompts:  76%|███████▋  | 281/368 [00:11<00:01, 58.65it/s, est. speed input: 2497.30 toks/s, output: 401.07 toks/s]Processed prompts:  88%|████████▊ | 323/368 [00:11<00:00, 80.56it/s, est. speed input: 2827.77 toks/s, output: 477.03 toks/s]Processed prompts:  95%|█████████▍| 349/368 [00:12<00:00, 88.76it/s, est. speed input: 3001.27 toks/s, output: 536.51 toks/s]Processed prompts: 100%|██████████| 368/368 [00:12<00:00, 29.01it/s, est. speed input: 3035.38 toks/s, output: 587.21 toks/s]
Processed prompts:   0%|          | 0/28 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   4%|▎         | 1/28 [00:00<00:24,  1.09it/s, est. speed input: 106.21 toks/s, output: 10.95 toks/s]Processed prompts:  43%|████▎     | 12/28 [00:01<00:01, 13.58it/s, est. speed input: 1152.80 toks/s, output: 119.77 toks/s]Processed prompts:  96%|█████████▋| 27/28 [00:01<00:00, 30.25it/s, est. speed input: 2192.25 toks/s, output: 382.56 toks/s]Processed prompts: 100%|██████████| 28/28 [00:01<00:00, 17.52it/s, est. speed input: 1844.56 toks/s, output: 344.76 toks/s]
[rank0]:[W314 15:24:30.065506496 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Exception ignored in: <function VLLM.__del__ at 0x7f1a480bde40>
Traceback (most recent call last):
  File "/dss/dsshome1/02/ra42vur3/miniforge3/envs/py312/lib/python3.12/site-packages/promptolution/llms/vllm.py", line 167, in __del__
AttributeError: 'NoneType' object has no attribute 'cuda'
