Running experiment with args: {'experiment_name': 'benchmark_experiment_sst-5_llama_CAPO_42', 'random_seed': 42, 'budget_per_run': 10000000, 'output_dir': 'results//sst-5/llama/CAPO/seed42/', 'dataset': 'sst-5', 'model': 'vllm-shuyuej/Llama-3.3-70B-Instruct-GPTQ', 'model_revision': '3a7f7f7d46e362291821aaefb0a38b632f1190a8', 'max_model_len': 1024, 'batch_size': None, 'model_storage_path': '../models/', 'optimizer': 'CAPO', 'n_steps': 999, 'population_size': 12, 'n_eval_samples': None, 'evoprompt_ga_template': 'standard', 'block_size': 30, 'length_penalty': 0.05, 'crossovers_per_iter': 4, 'upper_shots': 8, 'max_n_blocks_eval': 10, 'alpha': 0.2, 'shuffle_blocks_per_iter': False}
Found 28 unique prompts
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:73: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = config.target(df)
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:73: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = config.target(df)
/dss/dsshome1/02/ra42vur3/miniforge3/envs/py312/lib/python3.12/site-packages/promptolution/tasks/classification_tasks.py:56: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[y_column] = df[y_column].str.lower()
Loading safetensors checkpoint shards:   0% Completed | 0/8 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  12% Completed | 1/8 [00:15<01:49, 15.63s/it]
Loading safetensors checkpoint shards:  25% Completed | 2/8 [00:31<01:35, 15.91s/it]
Loading safetensors checkpoint shards:  38% Completed | 3/8 [00:39<01:00, 12.15s/it]
Loading safetensors checkpoint shards:  50% Completed | 4/8 [00:54<00:52, 13.14s/it]
Loading safetensors checkpoint shards:  62% Completed | 5/8 [01:11<00:43, 14.64s/it]
Loading safetensors checkpoint shards:  75% Completed | 6/8 [01:27<00:30, 15.03s/it]
Loading safetensors checkpoint shards:  88% Completed | 7/8 [01:42<00:15, 15.29s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [01:58<00:00, 15.41s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [01:58<00:00, 14.83s/it]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:30,  1.10it/s]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:29,  1.12it/s]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:02<00:28,  1.13it/s]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:03<00:27,  1.14it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:04<00:25,  1.18it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:05<00:24,  1.19it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:05<00:22,  1.22it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:06<00:22,  1.22it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:07<00:20,  1.28it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:08<00:19,  1.29it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:08<00:18,  1.31it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:09<00:17,  1.34it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:10<00:16,  1.35it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:11<00:15,  1.37it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:11<00:14,  1.40it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:12<00:13,  1.42it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:13<00:12,  1.44it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:13<00:11,  1.46it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:14<00:10,  1.50it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:15<00:09,  1.53it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:15<00:08,  1.57it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:16<00:08,  1.56it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:16<00:07,  1.58it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:17<00:06,  1.61it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:18<00:05,  1.68it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:18<00:05,  1.73it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:19<00:04,  1.78it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:19<00:03,  1.82it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:20<00:03,  1.82it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:20<00:02,  1.87it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:21<00:02,  1.90it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:21<00:01,  1.91it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:22<00:01,  1.94it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:22<00:00,  1.95it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:23<00:00,  1.97it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:23<00:00,  1.51it/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:12<23:58, 12.96s/it, est. speed input: 12.19 toks/s, output: 1.08 toks/s]Processed prompts:  96%|█████████▋| 108/112 [00:13<00:00, 10.87it/s, est. speed input: 1130.91 toks/s, output: 114.02 toks/s]Processed prompts: 100%|██████████| 112/112 [00:15<00:00,  7.33it/s, est. speed input: 1057.17 toks/s, output: 121.48 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:12<23:54, 12.93s/it, est. speed input: 10.91 toks/s, output: 1.08 toks/s]Processed prompts:  98%|█████████▊| 110/112 [00:13<00:00, 11.27it/s, est. speed input: 1159.43 toks/s, output: 117.68 toks/s]Processed prompts: 100%|██████████| 112/112 [00:15<00:00,  7.12it/s, est. speed input: 1019.87 toks/s, output: 112.63 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:12<23:57, 12.95s/it, est. speed input: 10.35 toks/s, output: 1.08 toks/s]Processed prompts:  96%|█████████▋| 108/112 [00:13<00:00, 11.00it/s, est. speed input: 1137.28 toks/s, output: 114.48 toks/s]Processed prompts: 100%|██████████| 112/112 [00:18<00:00,  6.21it/s, est. speed input: 891.85 toks/s, output: 108.53 toks/s] 
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:12<23:35, 12.75s/it, est. speed input: 12.31 toks/s, output: 1.10 toks/s]Processed prompts:  93%|█████████▎| 104/112 [00:13<00:00, 10.71it/s, est. speed input: 1094.88 toks/s, output: 112.24 toks/s]Processed prompts: 100%|██████████| 112/112 [00:17<00:00,  6.53it/s, est. speed input: 923.92 toks/s, output: 115.59 toks/s] 
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:11<20:55, 11.31s/it, est. speed input: 12.11 toks/s, output: 1.24 toks/s]Processed prompts: 100%|██████████| 112/112 [00:16<00:00,  8.36it/s, est. speed input: 830.41 toks/s, output: 105.49 toks/s]Processed prompts: 100%|██████████| 112/112 [00:16<00:00,  6.68it/s, est. speed input: 830.41 toks/s, output: 105.49 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:09<18:10,  9.82s/it, est. speed input: 12.93 toks/s, output: 1.43 toks/s]Processed prompts: 100%|██████████| 112/112 [00:09<00:00, 11.34it/s, est. speed input: 1192.36 toks/s, output: 163.18 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:09<18:13,  9.85s/it, est. speed input: 10.66 toks/s, output: 1.42 toks/s]Processed prompts: 100%|██████████| 112/112 [00:09<00:00, 11.31it/s, est. speed input: 1191.47 toks/s, output: 162.36 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:09<18:08,  9.81s/it, est. speed input: 11.52 toks/s, output: 1.43 toks/s]Processed prompts: 100%|██████████| 112/112 [00:09<00:00, 11.37it/s, est. speed input: 1187.14 toks/s, output: 162.39 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:10<19:23, 10.48s/it, est. speed input: 10.21 toks/s, output: 1.34 toks/s]Processed prompts: 100%|██████████| 112/112 [00:10<00:00, 10.63it/s, est. speed input: 1204.78 toks/s, output: 152.78 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:19<36:45, 19.86s/it, est. speed input: 11.28 toks/s, output: 0.70 toks/s]Processed prompts:  98%|█████████▊| 110/112 [00:25<00:00,  5.60it/s, est. speed input: 1004.23 toks/s, output: 67.53 toks/s]Processed prompts: 100%|██████████| 112/112 [00:26<00:00,  5.42it/s, est. speed input: 988.60 toks/s, output: 80.06 toks/s] Processed prompts: 100%|██████████| 112/112 [00:26<00:00,  4.25it/s, est. speed input: 988.60 toks/s, output: 80.06 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:19<36:37, 19.80s/it, est. speed input: 12.32 toks/s, output: 0.71 toks/s]Processed prompts: 100%|██████████| 112/112 [00:23<00:00,  6.52it/s, est. speed input: 1126.24 toks/s, output: 73.46 toks/s]Processed prompts: 100%|██████████| 112/112 [00:23<00:00,  4.85it/s, est. speed input: 1126.24 toks/s, output: 73.46 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:19<36:51, 19.93s/it, est. speed input: 11.54 toks/s, output: 0.70 toks/s]Processed prompts:  99%|█████████▉| 111/112 [00:26<00:00,  5.34it/s, est. speed input: 970.91 toks/s, output: 66.27 toks/s]Processed prompts: 100%|██████████| 112/112 [00:26<00:00,  4.18it/s, est. speed input: 976.37 toks/s, output: 73.94 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:19<36:07, 19.53s/it, est. speed input: 12.29 toks/s, output: 0.72 toks/s]Processed prompts:  98%|█████████▊| 110/112 [00:20<00:00,  7.39it/s, est. speed input: 1220.71 toks/s, output: 77.24 toks/s]Processed prompts: 100%|██████████| 112/112 [00:26<00:00,  4.29it/s, est. speed input: 984.35 toks/s, output: 76.30 toks/s] 
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:25<47:29, 25.67s/it, est. speed input: 8.45 toks/s, output: 0.55 toks/s]Processed prompts: 100%|██████████| 112/112 [00:28<00:00,  5.49it/s, est. speed input: 1215.79 toks/s, output: 60.01 toks/s]Processed prompts: 100%|██████████| 112/112 [00:28<00:00,  3.99it/s, est. speed input: 1215.79 toks/s, output: 60.01 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:29<54:01, 29.20s/it, est. speed input: 11.68 toks/s, output: 0.48 toks/s]Processed prompts:  97%|█████████▋| 109/112 [00:29<00:00,  5.14it/s, est. speed input: 1272.32 toks/s, output: 53.15 toks/s]Processed prompts: 100%|██████████| 112/112 [00:30<00:00,  3.70it/s, est. speed input: 1290.28 toks/s, output: 56.80 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:29<53:59, 29.18s/it, est. speed input: 12.20 toks/s, output: 0.48 toks/s]Processed prompts:  99%|█████████▉| 111/112 [00:30<00:00,  4.99it/s, est. speed input: 1251.30 toks/s, output: 53.39 toks/s]Processed prompts: 100%|██████████| 112/112 [00:31<00:00,  3.59it/s, est. speed input: 1249.66 toks/s, output: 55.16 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [00:29<53:48, 29.08s/it, est. speed input: 12.31 toks/s, output: 0.48 toks/s]Processed prompts:  96%|█████████▌| 107/112 [00:29<00:00,  5.15it/s, est. speed input: 1263.05 toks/s, output: 52.43 toks/s]Processed prompts: 100%|██████████| 112/112 [00:32<00:00,  3.44it/s, est. speed input: 1193.04 toks/s, output: 58.55 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]