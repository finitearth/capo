Running experiment with args: {'experiment_name': 'benchmark_experiment_subj_qwen_CAPO_43', 'random_seed': 43, 'budget_per_run': 10000000, 'output_dir': 'results//subj/qwen/CAPO/seed43/', 'dataset': 'subj', 'model': 'vllm-Qwen/Qwen2.5-32B-Instruct-GPTQ-Int4', 'model_revision': 'c83e67dfb2664f5039fd4cd99e206799e27dd800', 'max_model_len': 1024, 'batch_size': None, 'model_storage_path': '../models/', 'optimizer': 'CAPO', 'n_steps': 999, 'population_size': 12, 'n_eval_samples': None, 'evoprompt_ga_template': 'standard', 'block_size': 30, 'length_penalty': 0.05, 'crossovers_per_iter': 4, 'upper_shots': 8, 'max_n_blocks_eval': 10, 'alpha': 0.2, 'shuffle_blocks_per_iter': False}
Found 45 unique prompts
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
/dss/dsshome1/08/ra42zak2/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/08/ra42zak2/prompt_tuning/capo/capo/load_datasets.py:75: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = df[config.target]
/dss/dsshome1/08/ra42zak2/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/08/ra42zak2/prompt_tuning/capo/capo/load_datasets.py:75: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = df[config.target]
/dss/dsshome1/08/ra42zak2/miniforge3/envs/py312/lib/python3.12/site-packages/promptolution/tasks/classification_tasks.py:56: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[y_column] = df[y_column].str.lower()
Loading safetensors checkpoint shards:   0% Completed | 0/5 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  20% Completed | 1/5 [00:01<00:06,  1.53s/it]
Loading safetensors checkpoint shards:  40% Completed | 2/5 [00:03<00:05,  1.68s/it]
Loading safetensors checkpoint shards:  60% Completed | 3/5 [00:05<00:03,  1.73s/it]
Loading safetensors checkpoint shards:  80% Completed | 4/5 [00:06<00:01,  1.76s/it]
Loading safetensors checkpoint shards: 100% Completed | 5/5 [00:08<00:00,  1.77s/it]
Loading safetensors checkpoint shards: 100% Completed | 5/5 [00:08<00:00,  1.74s/it]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:29,  1.15it/s]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:23,  1.40it/s]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:02<00:21,  1.49it/s]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:02<00:20,  1.50it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:03<00:19,  1.54it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:04<00:18,  1.53it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:04<00:17,  1.56it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:05<00:17,  1.57it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:05<00:15,  1.63it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:06<00:15,  1.63it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:07<00:14,  1.65it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:07<00:13,  1.69it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:08<00:13,  1.68it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:08<00:12,  1.70it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:09<00:11,  1.74it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:09<00:10,  1.76it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:10<00:10,  1.79it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:10<00:09,  1.79it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:11<00:08,  1.79it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:12<00:08,  1.83it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:12<00:07,  1.86it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:13<00:06,  1.88it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:13<00:06,  1.89it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:14<00:05,  1.87it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:14<00:05,  1.92it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:15<00:04,  1.95it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:15<00:04,  1.99it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:16<00:03,  2.02it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:16<00:02,  2.04it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:17<00:02,  2.06it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:17<00:01,  2.06it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:18<00:01,  2.03it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:18<00:00,  2.04it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:19<00:00,  2.03it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:19<00:00,  2.05it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:19<00:00,  1.79it/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:29<1:41:58, 29.13s/it, est. speed input: 14.21 toks/s, output: 0.45 toks/s]Processed prompts:  70%|███████   | 148/211 [00:29<00:08,  7.20it/s, est. speed input: 2069.84 toks/s, output: 68.22 toks/s]Processed prompts: 100%|██████████| 211/211 [00:35<00:00,  5.88it/s, est. speed input: 2407.34 toks/s, output: 278.86 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:29<1:42:49, 29.38s/it, est. speed input: 13.45 toks/s, output: 0.44 toks/s]Processed prompts:  69%|██████▊   | 145/211 [00:29<00:09,  6.99it/s, est. speed input: 2003.18 toks/s, output: 66.33 toks/s]Processed prompts: 100%|██████████| 211/211 [00:36<00:00,  5.77it/s, est. speed input: 2353.67 toks/s, output: 295.67 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:26<1:32:49, 26.52s/it, est. speed input: 15.91 toks/s, output: 0.49 toks/s]Processed prompts:  82%|████████▏ | 174/211 [00:26<00:03,  9.30it/s, est. speed input: 2399.61 toks/s, output: 87.96 toks/s]Processed prompts: 100%|██████████| 211/211 [00:32<00:00,  6.54it/s, est. speed input: 2418.85 toks/s, output: 235.11 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:25<1:27:43, 25.07s/it, est. speed input: 14.04 toks/s, output: 0.52 toks/s]Processed prompts:  86%|████████▌ | 181/211 [00:25<00:02, 10.14it/s, est. speed input: 2487.23 toks/s, output: 96.47 toks/s]Processed prompts: 100%|██████████| 211/211 [00:30<00:00,  6.89it/s, est. speed input: 2396.25 toks/s, output: 242.98 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:22<1:17:48, 22.23s/it, est. speed input: 15.07 toks/s, output: 0.58 toks/s]Processed prompts:  89%|████████▉ | 188/211 [00:24<00:02, 10.73it/s, est. speed input: 2363.06 toks/s, output: 108.67 toks/s]Processed prompts:  94%|█████████▍| 198/211 [00:27<00:01,  8.90it/s, est. speed input: 2167.44 toks/s, output: 149.72 toks/s]Processed prompts: 100%|██████████| 211/211 [00:27<00:00,  7.59it/s, est. speed input: 2323.73 toks/s, output: 269.40 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:14<50:35, 14.46s/it, est. speed input: 13.42 toks/s, output: 0.90 toks/s]Processed prompts:  91%|█████████ | 192/211 [00:14<00:01, 18.57it/s, est. speed input: 2525.89 toks/s, output: 177.76 toks/s]Processed prompts: 100%|██████████| 211/211 [00:19<00:00, 10.93it/s, est. speed input: 2101.24 toks/s, output: 265.48 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:14<50:04, 14.31s/it, est. speed input: 13.56 toks/s, output: 0.91 toks/s]Processed prompts:  91%|█████████▏| 193/211 [00:14<00:00, 18.83it/s, est. speed input: 2534.41 toks/s, output: 181.82 toks/s]Processed prompts: 100%|██████████| 211/211 [00:19<00:00, 10.94it/s, est. speed input: 2085.27 toks/s, output: 288.83 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:17<1:00:34, 17.31s/it, est. speed input: 10.52 toks/s, output: 0.75 toks/s]Processed prompts:   6%|▌         | 13/211 [00:17<03:10,  1.04it/s, est. speed input: 143.01 toks/s, output: 9.76 toks/s]Processed prompts:  49%|████▉     | 103/211 [00:17<00:09, 11.36it/s, est. speed input: 1348.95 toks/s, output: 86.01 toks/s]Processed prompts:  96%|█████████▌| 203/211 [00:18<00:00, 23.20it/s, est. speed input: 2536.41 toks/s, output: 169.05 toks/s]Processed prompts: 100%|██████████| 211/211 [00:22<00:00,  9.59it/s, est. speed input: 2247.80 toks/s, output: 203.38 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:16<59:09, 16.90s/it, est. speed input: 14.79 toks/s, output: 0.35 toks/s]Processed prompts:   1%|          | 2/211 [00:17<26:13,  7.53s/it, est. speed input: 27.04 toks/s, output: 1.18 toks/s]Processed prompts:  94%|█████████▍| 199/211 [00:18<00:00, 20.63it/s, est. speed input: 2570.40 toks/s, output: 168.34 toks/s]Processed prompts: 100%|██████████| 211/211 [00:22<00:00,  9.36it/s, est. speed input: 2237.84 toks/s, output: 233.80 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:19<1:06:42, 19.06s/it, est. speed input: 16.06 toks/s, output: 0.31 toks/s]Processed prompts:  16%|█▌        | 33/211 [00:19<01:16,  2.32it/s, est. speed input: 497.01 toks/s, output: 10.40 toks/s]Processed prompts:  35%|███▌      | 74/211 [00:19<00:21,  6.36it/s, est. speed input: 987.45 toks/s, output: 41.12 toks/s]Processed prompts:  80%|███████▉  | 168/211 [00:20<00:02, 19.39it/s, est. speed input: 2202.84 toks/s, output: 118.18 toks/s]Processed prompts: 100%|██████████| 211/211 [00:25<00:00, 14.01it/s, est. speed input: 2276.52 toks/s, output: 242.46 toks/s]Processed prompts: 100%|██████████| 211/211 [00:25<00:00,  8.40it/s, est. speed input: 2276.52 toks/s, output: 242.46 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:21<1:13:40, 21.05s/it, est. speed input: 13.68 toks/s, output: 0.29 toks/s]Processed prompts:  26%|██▌       | 55/211 [00:21<00:43,  3.55it/s, est. speed input: 759.34 toks/s, output: 15.56 toks/s]Processed prompts:  30%|██▉       | 63/211 [00:21<00:35,  4.19it/s, est. speed input: 860.85 toks/s, output: 21.39 toks/s]Processed prompts:  64%|██████▍   | 136/211 [00:22<00:05, 12.99it/s, est. speed input: 1830.28 toks/s, output: 78.26 toks/s]Processed prompts:  70%|███████   | 148/211 [00:23<00:05, 12.36it/s, est. speed input: 1884.48 toks/s, output: 94.44 toks/s]Processed prompts:  74%|███████▍  | 156/211 [00:23<00:04, 13.17it/s, est. speed input: 1959.85 toks/s, output: 110.85 toks/s]Processed prompts:  77%|███████▋  | 162/211 [00:24<00:03, 14.23it/s, est. speed input: 2022.27 toks/s, output: 124.77 toks/s]Processed prompts:  80%|███████▉  | 168/211 [00:24<00:02, 15.39it/s, est. speed input: 2080.44 toks/s, output: 139.32 toks/s]Processed prompts:  82%|████████▏ | 174/211 [00:24<00:02, 17.33it/s, est. speed input: 2143.83 toks/s, output: 155.33 toks/s]Processed prompts:  85%|████████▍ | 179/211 [00:24<00:01, 16.87it/s, est. speed input: 2177.02 toks/s, output: 168.94 toks/s]Processed prompts:  87%|████████▋ | 183/211 [00:25<00:01, 16.37it/s, est. speed input: 2201.30 toks/s, output: 180.74 toks/s]Processed prompts:  88%|████████▊ | 186/211 [00:25<00:01, 16.46it/s, est. speed input: 2223.22 toks/s, output: 190.94 toks/s]Processed prompts:  90%|█████████ | 190/211 [00:25<00:01, 18.44it/s, est. speed input: 2259.80 toks/s, output: 205.98 toks/s]Processed prompts:  92%|█████████▏| 194/211 [00:25<00:00, 20.64it/s, est. speed input: 2296.36 toks/s, output: 221.80 toks/s]Processed prompts:  93%|█████████▎| 197/211 [00:25<00:00, 14.79it/s, est. speed input: 2292.99 toks/s, output: 232.57 toks/s]Processed prompts:  95%|█████████▍| 200/211 [00:26<00:00, 13.05it/s, est. speed input: 2299.21 toks/s, output: 245.39 toks/s]Processed prompts:  96%|█████████▌| 202/211 [00:26<00:00, 12.69it/s, est. speed input: 2306.52 toks/s, output: 255.03 toks/s]Processed prompts:  97%|█████████▋| 204/211 [00:26<00:00, 11.61it/s, est. speed input: 2308.14 toks/s, output: 264.85 toks/s]Processed prompts:  98%|█████████▊| 206/211 [00:28<00:01,  3.87it/s, est. speed input: 2188.73 toks/s, output: 264.35 toks/s]Processed prompts: 100%|██████████| 211/211 [00:28<00:00,  7.45it/s, est. speed input: 2240.54 toks/s, output: 309.54 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:19<1:09:23, 19.83s/it, est. speed input: 14.52 toks/s, output: 0.30 toks/s]Processed prompts:  22%|██▏       | 46/211 [00:20<00:52,  3.15it/s, est. speed input: 666.88 toks/s, output: 13.84 toks/s]Processed prompts:  37%|███▋      | 78/211 [00:20<00:21,  6.20it/s, est. speed input: 972.27 toks/s, output: 35.27 toks/s]Processed prompts:  44%|████▍     | 93/211 [00:20<00:14,  8.10it/s, est. speed input: 1175.10 toks/s, output: 47.13 toks/s]Processed prompts:  73%|███████▎  | 153/211 [00:21<00:03, 18.68it/s, est. speed input: 2013.95 toks/s, output: 96.92 toks/s]Processed prompts:  80%|████████  | 169/211 [00:22<00:02, 17.39it/s, est. speed input: 2113.41 toks/s, output: 120.47 toks/s]Processed prompts:  85%|████████▌ | 180/211 [00:22<00:01, 19.02it/s, est. speed input: 2234.52 toks/s, output: 150.36 toks/s]Processed prompts:  90%|████████▉ | 189/211 [00:23<00:01, 18.99it/s, est. speed input: 2304.81 toks/s, output: 178.09 toks/s]Processed prompts:  93%|█████████▎| 196/211 [00:23<00:00, 20.29it/s, est. speed input: 2375.36 toks/s, output: 204.07 toks/s]Processed prompts:  96%|█████████▌| 202/211 [00:23<00:00, 21.76it/s, est. speed input: 2434.49 toks/s, output: 228.65 toks/s]Processed prompts:  98%|█████████▊| 207/211 [00:24<00:00, 13.97it/s, est. speed input: 2387.19 toks/s, output: 244.89 toks/s]Processed prompts: 100%|██████████| 211/211 [00:26<00:00,  7.99it/s, est. speed input: 2274.44 toks/s, output: 267.71 toks/s]Processed prompts: 100%|██████████| 211/211 [00:26<00:00,  8.05it/s, est. speed input: 2274.44 toks/s, output: 267.71 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:13<46:27, 13.27s/it, est. speed input: 12.58 toks/s, output: 0.53 toks/s]Processed prompts:   2%|▏         | 5/211 [00:13<06:51,  2.00s/it, est. speed input: 63.47 toks/s, output: 2.69 toks/s]Processed prompts:   4%|▍         | 9/211 [00:13<03:16,  1.03it/s, est. speed input: 112.60 toks/s, output: 6.26 toks/s]Processed prompts:  74%|███████▍  | 157/211 [00:14<00:01, 30.12it/s, est. speed input: 2090.83 toks/s, output: 150.89 toks/s]Processed prompts: 100%|██████████| 211/211 [00:19<00:00, 10.80it/s, est. speed input: 1995.40 toks/s, output: 407.17 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/211 [00:13<46:17, 13.23s/it, est. speed input: 14.59 toks/s, output: 0.53 toks/s]Processed prompts:   1%|▏         | 3/211 [00:13<12:42,  3.66s/it, est. speed input: 41.27 toks/s, output: 1.95 toks/s]Processed prompts:  73%|███████▎  | 155/211 [00:13<00:02, 21.84it/s, est. speed input: 2055.33 toks/s, output: 150.35 toks/s]Processed prompts: 100%|██████████| 211/211 [00:19<00:00, 10.70it/s, est. speed input: 1971.43 toks/s, output: 425.09 toks/s]
Processed prompts:   0%|          | 0/211 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]