Running experiment with args: {'experiment_name': 'benchmark_experiment_gsm8k_llama_CAPO_44', 'random_seed': 44, 'budget_per_run': 10000000, 'output_dir': 'results//gsm8k/llama/CAPO/seed44/', 'dataset': 'gsm8k', 'model': 'vllm-shuyuej/Llama-3.3-70B-Instruct-GPTQ', 'model_revision': '3a7f7f7d46e362291821aaefb0a38b632f1190a8', 'max_model_len': 1024, 'batch_size': None, 'model_storage_path': '../models/', 'optimizer': 'CAPO', 'n_steps': 999, 'population_size': 12, 'n_eval_samples': None, 'evoprompt_ga_template': 'standard', 'block_size': 30, 'length_penalty': 0.05, 'crossovers_per_iter': 4, 'upper_shots': 8, 'max_n_blocks_eval': 10, 'alpha': 0.2, 'shuffle_blocks_per_iter': False}
Found 28 unique prompts
/dss/dsshome1/08/ra42zak2/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/08/ra42zak2/prompt_tuning/capo/capo/load_datasets.py:73: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = config.target(df)
/dss/dsshome1/08/ra42zak2/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/08/ra42zak2/prompt_tuning/capo/capo/load_datasets.py:73: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = config.target(df)
/dss/dsshome1/08/ra42zak2/miniforge3/envs/py312/lib/python3.12/site-packages/promptolution/tasks/classification_tasks.py:56: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[y_column] = df[y_column].str.lower()
Loading safetensors checkpoint shards:   0% Completed | 0/8 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  12% Completed | 1/8 [00:02<00:20,  2.88s/it]
Loading safetensors checkpoint shards:  25% Completed | 2/8 [00:05<00:17,  2.94s/it]
Loading safetensors checkpoint shards:  38% Completed | 3/8 [00:07<00:11,  2.25s/it]
Loading safetensors checkpoint shards:  50% Completed | 4/8 [00:09<00:09,  2.32s/it]
Loading safetensors checkpoint shards:  62% Completed | 5/8 [00:12<00:07,  2.53s/it]
Loading safetensors checkpoint shards:  75% Completed | 6/8 [00:15<00:05,  2.65s/it]
Loading safetensors checkpoint shards:  88% Completed | 7/8 [00:18<00:02,  2.73s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:21<00:00,  2.79s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:21<00:00,  2.67s/it]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:28,  1.18it/s]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:27,  1.21it/s]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:02<00:26,  1.22it/s]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:03<00:25,  1.24it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:04<00:23,  1.25it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:04<00:22,  1.27it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:05<00:21,  1.29it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:06<00:20,  1.30it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:07<00:19,  1.33it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:07<00:18,  1.35it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:08<00:17,  1.37it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:09<00:16,  1.39it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:09<00:15,  1.41it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:10<00:14,  1.43it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:11<00:13,  1.44it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:11<00:13,  1.45it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:12<00:12,  1.50it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:13<00:11,  1.52it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:13<00:10,  1.54it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:14<00:09,  1.57it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:14<00:08,  1.59it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:15<00:08,  1.61it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:16<00:07,  1.64it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:16<00:06,  1.65it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:17<00:05,  1.71it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:17<00:05,  1.75it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:18<00:04,  1.80it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:18<00:03,  1.84it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:19<00:03,  1.88it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:19<00:02,  1.91it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:20<00:02,  1.94it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:20<00:01,  1.96it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:21<00:01,  1.97it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:21<00:00,  1.98it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:22<00:00,  1.99it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:22<00:00,  1.57it/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   1%|          | 1/112 [01:09<2:08:54, 69.68s/it, est. speed input: 10.36 toks/s, output: 1.31 toks/s]Processed prompts:   2%|▏         | 2/112 [01:10<53:16, 29.06s/it, est. speed input: 20.51 toks/s, output: 2.66 toks/s]  Processed prompts:   3%|▎         | 3/112 [01:11<29:18, 16.13s/it, est. speed input: 30.61 toks/s, output: 4.07 toks/s]Processed prompts:   4%|▎         | 4/112 [01:11<17:55,  9.96s/it, est. speed input: 40.31 toks/s, output: 5.52 toks/s]Processed prompts:   4%|▍         | 5/112 [01:12<11:44,  6.59s/it, est. speed input: 49.88 toks/s, output: 7.01 toks/s]Processed prompts:   5%|▌         | 6/112 [01:12<08:03,  4.56s/it, est. speed input: 59.63 toks/s, output: 8.55 toks/s]Processed prompts:   6%|▋         | 7/112 [01:13<05:30,  3.15s/it, est. speed input: 69.31 toks/s, output: 10.13 toks/s]Processed prompts:   7%|▋         | 8/112 [01:13<03:47,  2.18s/it, est. speed input: 79.17 toks/s, output: 11.74 toks/s]Processed prompts:   8%|▊         | 9/112 [01:14<03:13,  1.88s/it, est. speed input: 87.64 toks/s, output: 13.29 toks/s]Processed prompts:   9%|▉         | 10/112 [01:14<02:16,  1.33s/it, est. speed input: 97.07 toks/s, output: 15.01 toks/s]Processed prompts:  12%|█▏        | 13/112 [01:14<00:59,  1.67it/s, est. speed input: 126.24 toks/s, output: 20.23 toks/s]Processed prompts:  13%|█▎        | 15/112 [01:14<00:41,  2.33it/s, est. speed input: 145.04 toks/s, output: 23.71 toks/s]Processed prompts:  15%|█▌        | 17/112 [01:14<00:29,  3.27it/s, est. speed input: 164.12 toks/s, output: 27.25 toks/s]Processed prompts:  17%|█▋        | 19/112 [01:15<00:30,  3.01it/s, est. speed input: 181.44 toks/s, output: 30.63 toks/s]Processed prompts:  18%|█▊        | 20/112 [01:15<00:26,  3.44it/s, est. speed input: 190.94 toks/s, output: 32.46 toks/s]Processed prompts:  19%|█▉        | 21/112 [01:15<00:22,  3.96it/s, est. speed input: 200.29 toks/s, output: 34.29 toks/s]Processed prompts:  21%|██        | 23/112 [01:16<00:15,  5.62it/s, est. speed input: 219.92 toks/s, output: 38.02 toks/s]Processed prompts:  23%|██▎       | 26/112 [01:16<00:09,  8.71it/s, est. speed input: 248.51 toks/s, output: 43.65 toks/s]Processed prompts:  25%|██▌       | 28/112 [01:16<00:09,  8.84it/s, est. speed input: 266.60 toks/s, output: 47.36 toks/s]Processed prompts:  27%|██▋       | 30/112 [01:16<00:09,  8.95it/s, est. speed input: 285.03 toks/s, output: 51.11 toks/s]Processed prompts:  29%|██▊       | 32/112 [01:16<00:10,  7.91it/s, est. speed input: 302.95 toks/s, output: 54.82 toks/s]Processed prompts:  30%|███       | 34/112 [01:17<00:09,  8.40it/s, est. speed input: 321.77 toks/s, output: 58.66 toks/s]Processed prompts:  32%|███▏      | 36/112 [01:17<00:08,  8.79it/s, est. speed input: 340.11 toks/s, output: 62.52 toks/s]Processed prompts:  34%|███▍      | 38/112 [01:17<00:08,  9.09it/s, est. speed input: 357.68 toks/s, output: 66.42 toks/s]Processed prompts:  36%|███▌      | 40/112 [01:18<00:10,  6.56it/s, est. speed input: 374.34 toks/s, output: 70.15 toks/s]Processed prompts:  37%|███▋      | 41/112 [01:18<00:10,  6.98it/s, est. speed input: 382.96 toks/s, output: 72.16 toks/s]Processed prompts:  38%|███▊      | 43/112 [01:18<00:08,  7.76it/s, est. speed input: 400.74 toks/s, output: 76.19 toks/s]Processed prompts:  43%|████▎     | 48/112 [01:18<00:07,  8.87it/s, est. speed input: 444.68 toks/s, output: 86.33 toks/s]Processed prompts:  45%|████▍     | 50/112 [01:18<00:06,  9.66it/s, est. speed input: 462.56 toks/s, output: 90.53 toks/s]Processed prompts:  46%|████▋     | 52/112 [01:19<00:06,  8.73it/s, est. speed input: 479.79 toks/s, output: 94.64 toks/s]Processed prompts:  50%|█████     | 56/112 [01:19<00:05, 11.20it/s, est. speed input: 515.66 toks/s, output: 103.33 toks/s]Processed prompts:  53%|█████▎    | 59/112 [01:19<00:04, 13.10it/s, est. speed input: 542.14 toks/s, output: 109.96 toks/s]Processed prompts:  54%|█████▍    | 61/112 [01:19<00:04, 11.02it/s, est. speed input: 558.37 toks/s, output: 114.19 toks/s]Processed prompts:  56%|█████▋    | 63/112 [01:20<00:04, 10.63it/s, est. speed input: 575.48 toks/s, output: 118.59 toks/s]Processed prompts:  58%|█████▊    | 65/112 [01:20<00:05,  8.81it/s, est. speed input: 591.30 toks/s, output: 122.90 toks/s]Processed prompts:  60%|█████▉    | 67/112 [01:20<00:04, 10.05it/s, est. speed input: 609.12 toks/s, output: 127.57 toks/s]Processed prompts:  62%|██████▎   | 70/112 [01:20<00:03, 12.83it/s, est. speed input: 636.47 toks/s, output: 134.71 toks/s]Processed prompts:  64%|██████▍   | 72/112 [01:20<00:02, 13.61it/s, est. speed input: 653.68 toks/s, output: 139.43 toks/s]Processed prompts:  67%|██████▋   | 75/112 [01:20<00:02, 14.54it/s, est. speed input: 680.10 toks/s, output: 146.59 toks/s]Processed prompts:  69%|██████▉   | 77/112 [01:21<00:04,  7.87it/s, est. speed input: 693.29 toks/s, output: 150.69 toks/s]Processed prompts:  71%|███████▏  | 80/112 [01:21<00:03,  9.07it/s, est. speed input: 718.23 toks/s, output: 158.14 toks/s]Processed prompts:  73%|███████▎  | 82/112 [01:22<00:03,  8.30it/s, est. speed input: 734.10 toks/s, output: 162.96 toks/s]Processed prompts:  75%|███████▌  | 84/112 [01:22<00:03,  9.22it/s, est. speed input: 751.40 toks/s, output: 168.13 toks/s]Processed prompts:  77%|███████▋  | 86/112 [01:22<00:02,  8.95it/s, est. speed input: 768.48 toks/s, output: 173.20 toks/s]Processed prompts:  79%|███████▊  | 88/112 [01:22<00:02,  9.33it/s, est. speed input: 785.81 toks/s, output: 178.44 toks/s]Processed prompts:  82%|████████▏ | 92/112 [01:22<00:01, 12.47it/s, est. speed input: 819.57 toks/s, output: 189.49 toks/s]Processed prompts:  84%|████████▍ | 94/112 [01:23<00:01,  9.04it/s, est. speed input: 833.70 toks/s, output: 194.44 toks/s]Processed prompts:  86%|████████▌ | 96/112 [01:23<00:01,  8.52it/s, est. speed input: 849.29 toks/s, output: 199.87 toks/s]Processed prompts: 100%|██████████| 112/112 [01:23<00:00,  1.34it/s, est. speed input: 991.51 toks/s, output: 248.62 toks/s]
Processed prompts:   0%|          | 0/112 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]