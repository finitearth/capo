Running experiment with args: {'experiment_name': 'benchmark_experiment_agnews_mistral_CAPO_43', 'random_seed': 43, 'budget_per_run': 10000000, 'output_dir': 'results//agnews/mistral/CAPO/seed43/', 'dataset': 'agnews', 'model': 'vllm-ConfidentialMind/Mistral-Small-24B-Instruct-2501_GPTQ_G128_W4A16_MSE', 'model_revision': '803393813b8fc4046fb663af2e3c56339a5b520b', 'max_model_len': 1024, 'batch_size': None, 'model_storage_path': '../models/', 'optimizer': 'CAPO', 'n_steps': 999, 'population_size': 12, 'n_eval_samples': None, 'evoprompt_ga_template': 'standard', 'block_size': 30, 'length_penalty': 0.05, 'crossovers_per_iter': 4, 'upper_shots': 8, 'max_n_blocks_eval': 10, 'alpha': 0.2, 'shuffle_blocks_per_iter': False}
Found 39 unique prompts
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:75: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = df[config.target]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:70: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "input"] = df[config.input]
/dss/dsshome1/02/ra42vur3/prompt_tuning/capo/capo/load_datasets.py:75: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df.loc[:, "target"] = df[config.target]
/dss/dsshome1/02/ra42vur3/miniforge3/envs/py312/lib/python3.12/site-packages/promptolution/tasks/classification_tasks.py:56: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[y_column] = df[y_column].str.lower()
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:02<00:06,  2.02s/it]
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:04<00:04,  2.08s/it]
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:05<00:01,  1.67s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:07<00:00,  1.76s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:07<00:00,  1.81s/it]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:18,  1.81it/s]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:18,  1.74it/s]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:18,  1.76it/s]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:02<00:17,  1.80it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:02<00:16,  1.84it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:03<00:15,  1.83it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:03<00:15,  1.83it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:04<00:14,  1.83it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:04<00:13,  1.88it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:05<00:13,  1.91it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:05<00:12,  1.92it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:06<00:12,  1.90it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:06<00:11,  1.93it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:07<00:10,  1.93it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:07<00:10,  1.96it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:08<00:09,  1.98it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:08<00:08,  2.02it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:09<00:08,  2.02it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:09<00:07,  2.00it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:10<00:07,  2.02it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:10<00:06,  2.04it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:11<00:06,  2.06it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:11<00:05,  2.08it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:12<00:05,  2.10it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:12<00:04,  2.10it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:13<00:04,  2.14it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:13<00:03,  2.17it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:14<00:03,  2.20it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:14<00:02,  2.23it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:15<00:02,  2.25it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:15<00:01,  2.25it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:15<00:01,  2.26it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:16<00:00,  2.21it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:16<00:00,  2.23it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:17<00:00,  2.23it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:17<00:00,  2.03it/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:36<3:42:41, 36.41s/it, est. speed input: 15.96 toks/s, output: 0.27 toks/s]Processed prompts:  22%|██▏       | 81/368 [00:47<02:10,  2.19it/s, est. speed input: 972.51 toks/s, output: 17.01 toks/s]Processed prompts:  51%|█████     | 187/368 [00:48<00:29,  6.21it/s, est. speed input: 2228.74 toks/s, output: 43.30 toks/s]Processed prompts:  58%|█████▊    | 213/368 [00:52<00:25,  6.19it/s, est. speed input: 2332.55 toks/s, output: 46.51 toks/s]Processed prompts:  68%|██████▊   | 252/368 [00:52<00:13,  8.50it/s, est. speed input: 2743.54 toks/s, output: 57.27 toks/s]Processed prompts:  90%|█████████ | 332/368 [00:52<00:02, 15.44it/s, est. speed input: 3605.75 toks/s, output: 74.29 toks/s]Processed prompts:  99%|█████████▉| 366/368 [00:53<00:00, 17.55it/s, est. speed input: 3903.40 toks/s, output: 83.50 toks/s]Processed prompts: 100%|██████████| 368/368 [00:56<00:00,  6.53it/s, est. speed input: 3745.66 toks/s, output: 86.15 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:27<2:46:21, 27.20s/it, est. speed input: 21.44 toks/s, output: 0.37 toks/s]Processed prompts:  37%|███▋      | 135/368 [00:34<00:45,  5.08it/s, est. speed input: 1428.21 toks/s, output: 39.02 toks/s]Processed prompts:  63%|██████▎   | 231/368 [00:34<00:13, 10.15it/s, est. speed input: 2732.35 toks/s, output: 72.91 toks/s]Processed prompts:  71%|███████   | 261/368 [00:35<00:08, 12.19it/s, est. speed input: 3112.04 toks/s, output: 84.17 toks/s]Processed prompts:  99%|█████████▉| 366/368 [00:35<00:00, 22.83it/s, est. speed input: 3897.20 toks/s, output: 116.24 toks/s]Processed prompts: 100%|██████████| 368/368 [00:38<00:00,  9.53it/s, est. speed input: 3596.70 toks/s, output: 119.62 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:17<1:47:10, 17.52s/it, est. speed input: 14.50 toks/s, output: 0.57 toks/s]Processed prompts:  57%|█████▋    | 209/368 [00:31<00:19,  8.03it/s, est. speed input: 1801.39 toks/s, output: 66.97 toks/s]Processed prompts:  68%|██████▊   | 251/368 [00:31<00:11, 10.24it/s, est. speed input: 2148.51 toks/s, output: 83.87 toks/s]Processed prompts:  75%|███████▍  | 275/368 [00:31<00:07, 11.85it/s, est. speed input: 2450.92 toks/s, output: 91.16 toks/s]Processed prompts:  98%|█████████▊| 362/368 [00:31<00:00, 21.06it/s, est. speed input: 3835.74 toks/s, output: 121.17 toks/s]Processed prompts: 100%|██████████| 368/368 [00:32<00:00, 11.26it/s, est. speed input: 3821.75 toks/s, output: 123.54 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:33<3:23:31, 33.27s/it, est. speed input: 15.75 toks/s, output: 0.30 toks/s]Processed prompts:  53%|█████▎    | 196/368 [00:47<00:32,  5.21it/s, est. speed input: 2146.22 toks/s, output: 41.28 toks/s]Processed prompts:  66%|██████▌   | 243/368 [00:47<00:17,  6.95it/s, est. speed input: 2650.84 toks/s, output: 53.95 toks/s]Processed prompts:  73%|███████▎  | 269/368 [00:47<00:12,  8.24it/s, est. speed input: 2917.60 toks/s, output: 60.12 toks/s]Processed prompts:  96%|█████████▌| 354/368 [00:48<00:00, 14.59it/s, est. speed input: 3826.46 toks/s, output: 79.21 toks/s]Processed prompts: 100%|██████████| 368/368 [00:48<00:00,  7.55it/s, est. speed input: 3926.89 toks/s, output: 88.61 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:32<3:17:38, 32.31s/it, est. speed input: 16.06 toks/s, output: 0.31 toks/s]Processed prompts:  52%|█████▏    | 193/368 [00:46<00:33,  5.29it/s, est. speed input: 2114.16 toks/s, output: 41.90 toks/s]Processed prompts:  68%|██████▊   | 251/368 [00:46<00:15,  7.51it/s, est. speed input: 2739.44 toks/s, output: 57.90 toks/s]Processed prompts:  77%|███████▋  | 282/368 [00:46<00:09,  9.09it/s, est. speed input: 3058.50 toks/s, output: 64.96 toks/s]Processed prompts:  99%|█████████▉| 366/368 [00:46<00:00, 15.44it/s, est. speed input: 3951.05 toks/s, output: 84.16 toks/s]Processed prompts: 100%|██████████| 368/368 [00:50<00:00,  7.34it/s, est. speed input: 3705.75 toks/s, output: 84.11 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:35<3:40:03, 35.98s/it, est. speed input: 14.04 toks/s, output: 0.28 toks/s]Processed prompts:  53%|█████▎    | 195/368 [00:54<00:38,  4.48it/s, est. speed input: 1991.33 toks/s, output: 35.97 toks/s]Processed prompts:  67%|██████▋   | 248/368 [00:54<00:19,  6.18it/s, est. speed input: 2557.73 toks/s, output: 48.34 toks/s]Processed prompts:  75%|███████▌  | 277/368 [00:54<00:12,  7.44it/s, est. speed input: 2894.51 toks/s, output: 53.75 toks/s]Processed prompts:  97%|█████████▋| 356/368 [00:54<00:00, 12.53it/s, est. speed input: 3841.36 toks/s, output: 69.99 toks/s]Processed prompts: 100%|██████████| 368/368 [00:55<00:00,  6.58it/s, est. speed input: 3910.66 toks/s, output: 77.37 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:42<4:18:28, 42.26s/it, est. speed input: 16.61 toks/s, output: 0.24 toks/s]Processed prompts:  49%|████▉     | 181/368 [01:01<00:50,  3.69it/s, est. speed input: 1954.42 toks/s, output: 29.42 toks/s]Processed prompts:  64%|██████▍   | 236/368 [01:01<00:25,  5.27it/s, est. speed input: 2534.82 toks/s, output: 40.60 toks/s]Processed prompts:  71%|███████   | 262/368 [01:02<00:16,  6.27it/s, est. speed input: 2803.18 toks/s, output: 45.41 toks/s]Processed prompts:  96%|█████████▋| 355/368 [01:02<00:01, 11.64it/s, est. speed input: 3861.14 toks/s, output: 61.87 toks/s]Processed prompts: 100%|██████████| 368/368 [01:05<00:00,  5.58it/s, est. speed input: 3778.17 toks/s, output: 81.22 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:46<4:42:32, 46.19s/it, est. speed input: 15.18 toks/s, output: 0.22 toks/s]Processed prompts:  54%|█████▍    | 200/368 [01:06<00:43,  3.82it/s, est. speed input: 2195.24 toks/s, output: 30.28 toks/s]Processed prompts:  67%|██████▋   | 248/368 [01:06<00:23,  5.11it/s, est. speed input: 2715.43 toks/s, output: 39.59 toks/s]Processed prompts:  74%|███████▍  | 274/368 [01:06<00:15,  6.05it/s, est. speed input: 2986.33 toks/s, output: 43.31 toks/s]Processed prompts:  98%|█████████▊| 359/368 [01:06<00:00, 10.64it/s, est. speed input: 3905.92 toks/s, output: 57.49 toks/s]Processed prompts: 100%|██████████| 368/368 [01:07<00:00,  5.43it/s, est. speed input: 3943.77 toks/s, output: 62.81 toks/s]
Processed prompts:   0%|          | 0/368 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/368 [00:39<4:01:22, 39.46s/it, est. speed input: 18.27 toks/s, output: 0.25 toks/s]